<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Contexte environnemental - Plantouille express</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script defer src="ui.js"></script>
  <script defer src="contexte.js"></script>
  <style>
    body{ background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; margin:0; padding:0; display:flex; flex-direction:column; min-height:100vh; }
    
    /* Navigation par onglets */
    .tabs-container { background: var(--card); box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
    .tabs { display: flex; border-bottom: 2px solid var(--border); }
    .tab { flex: 1; padding: 1rem; text-align: center; cursor: pointer; background: none; border: none; font-size: 1rem; color: var(--text); transition: all 0.3s; position: relative; }
    .tab:hover { background: rgba(56, 142, 60, 0.1); }
    .tab.active { color: var(--primary); font-weight: 600; }
    .tab.active::after { content: ''; position: absolute; bottom: -2px; left: 0; right: 0; height: 2px; background: var(--primary); }
    
    /* Contenu principal */
    .main-content { flex: 1; padding: 1.5rem; max-width: 900px; margin: 0 auto; width: 100%; }
    h1 { color: var(--primary); margin: 0 0 1.5rem; font-size: 1.6rem; text-align: center; }
    
    /* Options de localisation */
    .location-options { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 2rem; }
    .location-card { background: var(--card); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .location-card h2 { font-size: 1.2rem; color: var(--primary); margin: 0 0 1rem; }
    
    .action-button { padding: 12px 20px; background: var(--primary); color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%; }
    .action-button:hover { background: #2e7d32; transform: scale(1.02); }
    .action-button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
    
    /* Carte interactive */
    #map-container { display: none; margin-top: 1rem; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    #map { height: 400px; width: 100%; }
    
    /* Coordonn√©es s√©lectionn√©es */
    .coordinates-display { display: none; margin-top: 1rem; padding: 1rem; background: rgba(56, 142, 60, 0.1); border-radius: 6px; text-align: center; }
    .coordinates-display span { font-weight: 600; color: var(--primary); }
    
    /* R√©sultats */
    .results-section { display: none; margin-top: 2rem; }
    .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem; }
    .result-card { background: var(--card); border-radius: 8px; padding: 1rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .result-card h3 { color: var(--primary); margin: 0 0 0.5rem; font-size: 1.1rem; }
    .result-card a { display: inline-block; margin-top: 0.5rem; color: var(--primary); text-decoration: none; }
    .result-card a:hover { text-decoration: underline; }
    
    /* Chargement */
    .loading { display: none; text-align: center; margin: 2rem 0; }
    .loading::after { content: ''; display: inline-block; width: 30px; height: 30px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    /* Message d'instruction sur la carte */
    .map-instruction { display: none; position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.7); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; z-index: 1000; pointer-events: none; }
    
    @media (prefers-color-scheme:dark) { 
      .coordinates-display { background: rgba(56, 142, 60, 0.2); }
      .map-instruction { background: rgba(255, 255, 255, 0.15); }
    }
  </style>
</head>
<body>
  <!-- Navigation par onglets -->
  <nav class="tabs-container">
    <div class="tabs">
      <button class="tab" onclick="window.location.href='index.html'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon">   <path fill-rule="evenodd" d="M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z" clip-rule="evenodd"/> </svg>  <span>Identification</span></button>
      <button class="tab active"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon">   <path d="M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"/> </svg>  <span>Contexte environnemental</span></button>
      <button class="tab" onclick="window.location.href='notebook.html'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon">   <path d="M11.25 4.533A9.707 9.707 0 0 0 6 3a9.735 9.735 0 0 0-3.25.555.75.75 0 0 0-.5.707v14.25a.75.75 0 0 0 1 .707A8.237 8.237 0 0 1 6 18.75c1.995 0 3.823.707 5.25 1.886V4.533ZM12.75 20.636A8.214 8.214 0 0 1 18 18.75c.966 0 1.89.166 2.75.47a.75.75 0 0 0 1-.708V4.262a.75.75 0 0 0-.5-.707A9.735 9.735 0 0 0 18 3a9.707 9.707 0 0 0-5.25 1.533v16.103Z"/> </svg>  <span>Carnet</span></button>
    </div>
  </nav>

  <div class="main-content">
    <h1>Contexte environnemental</h1>
    
    <div class="location-options">
      <!-- Option 1: G√©olocalisation -->
      <div class="location-card">
        <h2>üìç Utiliser ma position actuelle</h2>
        <button class="action-button" id="use-geolocation">
          Utiliser ma localisation
        </button>
      </div>
      
      <!-- Option 2: S√©lection sur carte -->
      <div class="location-card">
        <h2>üó∫Ô∏è Choisir un endroit sur la carte</h2>
        <button class="action-button" id="choose-on-map">
          Ouvrir la carte
        </button>
        
        <div id="map-container">
          <div class="map-instruction" id="map-instruction">
            Cliquez longuement pour s√©lectionner un point
          </div>
          <div id="map"></div>
        </div>
        
        <div class="coordinates-display" id="coordinates-display">
          Coordonn√©es s√©lectionn√©es : 
          <span id="selected-coords">--</span>
        </div>
        
        <button class="action-button" id="validate-location" style="display:none; margin-top:1rem;">
          Valider cette localisation
        </button>
      </div>
    </div>
    
    <!-- Indicateur de chargement -->
    <div class="loading" id="loading"></div>
    
    <!-- Section des r√©sultats -->
    <div class="results-section" id="results-section">
      <h2>Ressources environnementales</h2>
      <p style="margin-bottom: 1rem; color: #666;">
        Cliquez sur les liens ci-dessous pour explorer le contexte environnemental de la zone s√©lectionn√©e :
      </p>
      <div class="results-grid" id="results-grid">
        <!-- Les cartes de r√©sultats seront ajout√©es ici dynamiquement -->
      </div>
    </div>
  </div>
</body>
</html>
